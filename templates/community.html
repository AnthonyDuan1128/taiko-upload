{% extends "base.html" %}
{% block title %}åˆ›ä½œè€…ç¤¾åŒº â€” å¤ªé¼“æŠ•ç¨¿{% endblock %}

{% block content %}
<div class="container">
    <div class="page-header animate-in">
        <h1>ğŸŒ åˆ›ä½œè€…ç¤¾åŒº</h1>
        <p>æµè§ˆå¹¶ç‚¹èµç¤¾åŒºåˆ›ä½œè€…åˆ†äº«çš„è‡ªåˆ¶è°±é¢</p>
    </div>

    {% if submissions.items %}
    <div class="card-grid">
        {% for sub in submissions.items %}
        <a href="{{ url_for('submission_detail', sid=sub.id) }}" class="card animate-in"
            style="text-decoration:none; color:inherit;">
            <div style="display:flex; align-items:center; justify-content:space-between; margin-bottom:0.5rem;">
                <span class="card-badge badge-category">{{ sub.song_type }}</span>
                <span style="font-size:0.75rem; color:var(--text-muted);">{{ sub.reviewed_at.strftime('%Y-%m-%d') if
                    sub.reviewed_at else '' }}</span>
            </div>
            <div class="card-title">{{ sub.title }}</div>
            {% if sub.artist %}
            <div class="card-artist">ğŸµ {{ sub.artist }}</div>
            {% endif %}
            <div class="card-meta">
                <span>ğŸ‘¤ {{ sub.author.username }}</span>
                <span>â¤ï¸ {{ sub.like_count }}</span>
                <span>ğŸ’¬ {{ sub.comment_count }}</span>
            </div>
        </a>
        {% endfor %}
    </div>

    <!-- Pagination -->
    {% if submissions.pages > 1 %}
    <div class="pagination">
        {% if submissions.has_prev %}
        <a href="{{ url_for('community', page=submissions.prev_num) }}">â€¹</a>
        {% else %}
        <span class="disabled">â€¹</span>
        {% endif %}

        {% for p in submissions.iter_pages(left_edge=1, right_edge=1, left_current=2, right_current=2) %}
        {% if p %}
        <a href="{{ url_for('community', page=p) }}" class="{% if p == submissions.page %}active-page{% endif %}">{{ p
            }}</a>
        {% else %}
        <span style="color:var(--text-muted);">â€¦</span>
        {% endif %}
        {% endfor %}

        {% if submissions.has_next %}
        <a href="{{ url_for('community', page=submissions.next_num) }}">â€º</a>
        {% else %}
        <span class="disabled">â€º</span>
        {% endif %}
    </div>
    {% endif %}

    {% else %}
    <div class="empty-state animate-in">
        <span class="icon">ğŸ¶</span>
        <p>ç¤¾åŒºæš‚æ— è°±é¢ï¼Œå¿«æ¥æˆä¸ºç¬¬ä¸€ä½æŠ•ç¨¿è€…ï¼</p>
        {% if current_user.is_authenticated %}
        <a href="{{ url_for('upload') }}" class="btn btn-primary">å»æŠ•ç¨¿</a>
        {% else %}
        <a href="{{ url_for('register') }}" class="btn btn-primary">æ³¨å†ŒæŠ•ç¨¿</a>
        {% endif %}
    </div>
    {% endif %}
</div>
{% endblock %}