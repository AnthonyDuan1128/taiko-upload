<!DOCTYPE html>
<html lang="zh-CN">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="å¤ªé¼“è‡ªåˆ¶è°±é¢æŠ•ç¨¿å¹³å° â€” ä¸Šä¼ ä½ çš„TJAè°±é¢ï¼Œåˆ†äº«ç»™ç¤¾åŒº">
    <title>{% block title %}å¤ªé¼“è°±é¢æŠ•ç¨¿{% endblock %}</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
</head>

<body>
    <!-- Navbar -->
    <nav class="navbar">
        <a href="{{ url_for('community') }}" class="navbar-brand">
            <span class="icon">ğŸ¥</span> å¤ªé¼“æŠ•ç¨¿
        </a>
        <div class="navbar-links">
            <a href="{{ url_for('community') }}" class="{% if request.endpoint == 'community' %}active{% endif %}">ğŸŒ
                ç¤¾åŒº</a>
            {% if current_user.is_authenticated %}
            <a href="{{ url_for('upload') }}" class="{% if request.endpoint == 'upload' %}active{% endif %}">ğŸ“¤ æŠ•ç¨¿</a>
            <a href="{{ url_for('dashboard') }}" class="{% if request.endpoint == 'dashboard' %}active{% endif %}">ğŸ“‹
                æˆ‘çš„</a>
            {% if current_user.is_admin %}
            <a href="{{ url_for('admin_panel') }}"
                class="{% if request.endpoint == 'admin_panel' %}active{% endif %}">âš™ï¸ ç®¡ç†</a>
            {% endif %}
            <a href="{{ url_for('logout') }}">é€€å‡º</a>
            {% else %}
            <a href="{{ url_for('login') }}" class="{% if request.endpoint == 'login' %}active{% endif %}">ç™»å½•</a>
            <a href="{{ url_for('register') }}" class="{% if request.endpoint == 'register' %}active{% endif %}">æ³¨å†Œ</a>
            {% endif %}
        </div>
    </nav>

    <!-- Flash messages -->
    {% with messages = get_flashed_messages(with_categories=true) %}
    {% if messages %}
    <div class="flash-container" id="flashContainer">
        {% for category, message in messages %}
        <div class="flash-msg flash-{{ category }}">{{ message }}</div>
        {% endfor %}
    </div>
    {% endif %}
    {% endwith %}

    <!-- Main content -->
    {% block content %}{% endblock %}

    <!-- Footer -->
    <footer class="site-footer">
        <p>ğŸ¥ å¤ªé¼“è‡ªåˆ¶è°±é¢æŠ•ç¨¿å¹³å° Â· Powered by <a href="https://taiko.asia" target="_blank">taiko.asia</a></p>
    </footer>

    <script>
        // Auto-dismiss flash messages
        setTimeout(() => {
            const fc = document.getElementById('flashContainer');
            if (fc) fc.style.transition = 'opacity 0.5s';
            if (fc) { fc.style.opacity = '0'; setTimeout(() => fc.remove(), 500); }
        }, 4000);
    </script>
    {% block scripts %}{% endblock %}
</body>

</html>